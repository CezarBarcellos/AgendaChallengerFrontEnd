<div class="compromissos-container">

  <h2>
    <i class="fas fa-calendar-alt"></i>
    {{ modoEdicao ? (editandoIndex !== null ? 'Editar Compromisso' : 'Novo Compromisso') : 'Lista de Compromissos' }}

    <!-- Botão para abrir o formulário Novo -->
    <button *ngIf="!modoEdicao" class="btn btn-add" (click)="abrirNovo()">
      <i class="fas fa-plus"></i> Novo
    </button>

    <!-- Botão para cancelar edição/criação -->
    <button *ngIf="modoEdicao" class="btn btn-cancel" (click)="cancelar()">
      <i class="fas fa-times"></i> Cancelar
    </button>
  </h2>

  <!-- Tabela com lista de compromissos -->
  <table *ngIf="!modoEdicao" class="grid">
    <thead>
      <tr>
        <th><i class="fas fa-heading"></i> Título</th>
        <th><i class="fas fa-align-left"></i> Descrição</th>
        <th><i class="fas fa-play"></i> Início</th>
        <th><i class="fas fa-stop"></i> Término</th>
        <th><i class="fas fa-map-marker-alt"></i> Localização</th>
        <th><i class="fas fa-info-circle"></i> Status</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of compromissos; let i = index">
        <td>{{ c.titulo }}</td>
        <td>{{ c.descricao }}</td>
        <td>{{ c.inicio | date: 'short' }}</td>
        <td>{{ c.termino | date: 'short' }}</td>
        <td>{{ c.localizacao }}</td>
        <td>
          <span [ngClass]="{
            'status-confirmado': c.status === 'confirmado',
            'status-pendente': c.status === 'pendente',
            'status-cancelado': c.status === 'cancelado'
          }">
            {{ c.status }}
          </span>
        </td>
        <td class="acoes">
          <button class="btn btn-edit" (click)="abrirEdicao(i)">
            <i class="fas fa-edit"></i>Editar
          </button>
          <button class="btn btn-delete" (click)="onExcluir(i)">
            <i class="fas fa-trash-alt"></i>Excluir
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Formulário Novo / Editar -->
  <form *ngIf="modoEdicao" [formGroup]="formCompromisso" (ngSubmit)="salvar()">
    <div class="form-group">
      <label for="titulo">Título</label>
      <input id="titulo" type="text" formControlName="titulo" required />
    </div>

    <div class="form-group">
      <label for="descricao">Descrição</label>
      <textarea id="descricao" formControlName="descricao" rows="3"></textarea>
    </div>

    <div class="form-group">
      <label for="inicio">Início</label>
      <input id="inicio" type="datetime-local" formControlName="inicio" required />
    </div>

    <div class="form-group">
      <label for="termino">Término</label>
      <input id="termino" type="datetime-local" formControlName="termino" required />
    </div>

    <div class="form-group">
      <label for="localizacao">Localização</label>
      <input id="localizacao" type="text" formControlName="localizacao" />
    </div>

    <div class="form-group">
      <label for="status">Status</label>
      <select id="status" formControlName="status" required>
        <option value="confirmado">Confirmado</option>
        <option value="pendente">Pendente</option>
        <option value="cancelado">Cancelado</option>
      </select>
    </div>

    <button type="submit" class="btn btn-save" [disabled]="formCompromisso.invalid">
      <i class="fas fa-save"></i> Salvar
    </button>
  </form>
</div>
